<div class="container">
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">User Management</h2>
      <button (click)="openAddModal()" class="btn btn-primary">Add User</button>
    </div>

    <div *ngIf="users.length === 0" class="text-center p-3">
      <p class="text-muted">No users found. Loading...</p>
    </div>

    <div class="table-container" *ngIf="users.length > 0">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Role</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of users">
            <td>{{ user.id }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.role }}</td>
            <td>{{ user.created_at | date:'short' }}</td>
            <td>
              <button (click)="openEditModal(user)" class="btn btn-sm btn-warning">Edit</button>
              <button (click)="deleteUser(user)" class="btn btn-sm btn-danger">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal -->
<div *ngIf="showModal" class="modal-overlay" (click)="closeModal()">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">{{ editMode ? 'Edit' : 'Add' }} User</h3>
      <button (click)="closeModal()" class="modal-close">Ã—</button>
    </div>

    <div class="form-group">
      <label class="form-label">Username *</label>
      <input type="text" class="form-control" [(ngModel)]="currentUser.username" required />
    </div>

    <div class="form-group">
      <label class="form-label">Password {{ editMode ? '(leave blank to keep current)' : '*' }}</label>
      <input type="password" class="form-control" [(ngModel)]="currentUser.password" [required]="!editMode" />
    </div>

    <div class="form-group">
      <label class="form-label">Role *</label>
      <select class="form-control" [(ngModel)]="currentUser.role" required>
        <option value="admin">Admin</option>
        <option value="manager">Manager</option>
        <option value="sales">Sales</option>
      </select>
    </div>

    <div class="modal-footer">
      <button (click)="closeModal()" class="btn btn-secondary">Cancel</button>
      <button (click)="saveUser()" class="btn btn-primary">Save</button>
    </div>
  </div>
</div>
